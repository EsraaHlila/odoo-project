<?xml version="1.0" encoding="utf-8"?>
<odoo>
  <!-- Report registration -->
  <report
    id="report_invoice_dmnova"
    model="account.move"
    string="Facture DMNova"
    report_type="qweb-pdf"
    name="dmnova_invoice_report.report_invoice_template"
    file="dmnova_invoice_report.report_invoice_template"
    print_report_name="'Facture - %s' % (object.name)"
  />

  <!-- QWeb template -->
  <template id="report_invoice_template">
    <t t-call="web.external_layout">
      <t t-set="company" t-value="docs[0].company_id"/>
      <div class="page" style="font-family: DejaVu Sans, Arial, Helvetica, sans-serif; font-size:12px; color:#111;">
        <!-- Header: replicate your PDF's header -->
        <div style="display:flex; justify-content:space-between; align-items:flex-start; margin-bottom:12px;">
          <div>
            <h2 style="margin:0 0 6px 0;">Facture</h2>
            <p style="margin:0;"><strong>Numéro :</strong> <span t-field="docs[0].name"/></p>
            <p style="margin:0;"><strong>Date :</strong> <span t-field="docs[0].invoice_date"/></p>
            <p style="margin:0;"><strong>Page :</strong> 1/1</p>
          </div>
          <div style="text-align:right;">
            <p style="margin:0;"><strong>DMNova / SoftTech la pépinière</strong></p>
            <p style="margin:0;">Novation City, Sousse, Tunisie - 4000</p>
            <p style="margin:0;">Matricule Fiscale : 1812882/V</p>
            <p style="margin:0;">RIB : 00178-0081876781-1 TND</p>
            <p style="margin:0;">+216 55 544 822</p>
            <p style="margin:0;">contact@dmnova.tech</p>
            <p style="margin:0;"><a t-attf-href="http://www.dmnova.tech">www.dmnova.tech</a></p>
          </div>
        </div>

        <hr style="border:none;border-top:1px solid #ddd;margin:8px 0 14px 0;" />

        <!-- Bill To -->
        <div style="margin-bottom:12px;">
          <p style="margin:0;"><strong>Client :</strong>
            <t t-if="docs[0].partner_id">
              <span t-field="docs[0].partner_id.name"/>
            </t>
            <t t-if="not docs[0].partner_id">
              -
            </t>
          </p>
        </div>

        <!-- Invoice lines table -->
        <table style="width:100%; border-collapse:collapse; margin-bottom:12px;">
          <thead>
            <tr>
              <th style="text-align:left; border-bottom:1px solid #ddd; padding:6px;">Produit/Service</th>
              <th style="text-align:right; border-bottom:1px solid #ddd; padding:6px; width:90px;">Tarif</th>
              <th style="text-align:right; border-bottom:1px solid #ddd; padding:6px; width:60px;">Qté</th>
              <th style="text-align:right; border-bottom:1px solid #ddd; padding:6px; width:120px;">Montant H.T DT</th>
            </tr>
          </thead>
          <tbody>
            <t t-foreach="docs[0].invoice_line_ids" t-as="l">
              <tr>
                <td style="padding:6px; vertical-align:top;">
                  <span t-field="l.name"/>
                </td>
                <td style="padding:6px; vertical-align:top; text-align:right;">
                  <span t-field="l.price_unit" t-options='{"widget":"monetary","display_currency": l.currency_id}'/>
                </td>
                <td style="padding:6px; vertical-align:top; text-align:right;">
                  <span t-field="l.quantity"/>
                </td>
                <td style="padding:6px; vertical-align:top; text-align:right;">
                  <span t-field="l.price_subtotal" t-options='{"widget":"monetary","display_currency": l.currency_id}'/>
                </td>
              </tr>
            </t>
          </tbody>
        </table>

        <!-- Totals block (right aligned) -->
        <div style="display:flex; justify-content:flex-end; margin-top:6px;">
          <table style="width:360px; border-collapse:collapse;">
            <tbody>
              <tr>
                <td style="padding:6px; border-top:1px solid #eee;">Sous total</td>
                <td style="padding:6px; border-top:1px solid #eee; text-align:right;">
                  <span t-field="docs[0].amount_untaxed" t-options='{"widget":"monetary","display_currency": docs[0].currency_id}'/>
                </td>
              </tr>
              <tr>
                <td style="padding:6px;">Taux TVA</td>
                <td style="padding:6px; text-align:right;">
                  <!-- show tax summary if exists -->
                  <t t-if="docs[0].tax_line_ids">
                    <t t-foreach="docs[0].tax_line_ids" t-as="tl">
                      <div>
                        <!--<span t-esc="tl.name"/> &nbsp; <span t-field="tl.amount" t-options='{"widget":"monetary","display_currency": docs[0].currency_id}'/>-->
						<span t-esc="tl.name"/> <span t-field="tl.amount" t-options='{"widget":"monetary","display_currency": docs[0].currency_id}'/>
						
                      </div>
                    </t>
                  </t>
                  <t t-if="not docs[0].tax_line_ids">-</t>
                </td>
              </tr>
              <tr>
                <td style="padding:6px;">Droit du Timbre</td>
                <td style="padding:6px; text-align:right;">
                  <!-- example fixed stamp duty if any: uses company field if set -->
                  <t t-if="docs[0].stamp_amount">
                    <span t-field="docs[0].stamp_amount" t-options='{"widget":"monetary","display_currency": docs[0].currency_id}'/>
                  </t>
                  <t t-if="not docs[0].stamp_amount">1.00 DT</t>
                </td>
              </tr>
              <tr>
                <td style="padding:6px; font-weight:bold; border-top:1px solid #ddd;">Total TTC</td>
                <td style="padding:6px; text-align:right; font-weight:bold; border-top:1px solid #ddd;">
                  <span t-field="docs[0].amount_total" t-options='{"widget":"monetary","display_currency": docs[0].currency_id}'/>
                </td>
              </tr>
            </tbody>
          </table>
        </div>

        <hr style="margin:14px 0 8px 0; border:none; border-top:1px solid #eee;" />

        <!-- Payment & Terms -->
        <div style="margin-top:8px;">
          <p style="margin:0;"><strong>Mode de paiement :</strong>
            <t t-if="docs[0].invoice_payment_term_id">
              <span t-field="docs[0].invoice_payment_term_id.name"/>
            </t>
            <t t-if="not docs[0].invoice_payment_term_id">
              Virement bancaire
            </t>
          </p>
          <p style="margin:0;"><strong>Date d'échéance :</strong>
            <t t-if="docs[0].invoice_date_due">
              <span t-field="docs[0].invoice_date_due"/>
            </t>
            <t t-if="not docs[0].invoice_date_due">-</t>
          </p>
        </div>

        <div style="margin-top:10px;">
          <p style="margin:0;"><strong>Conditions générales :</strong></p>
          <p style="margin:0 0 6px 0;">
            Nous vous prions de bien vouloir noter qu'un paiement initial de 30 % sera requis avant le lancement
            du développement de chaque section du projet. Les modalités de paiement pour les étapes suivantes
            seront convenues selon un plan détaillé, qui vous sera fourni dans un document séparé. Nous vous
            remercions de votre compréhension et de votre coopération dans ce processus.
          </p>
        </div>

        <!-- Footer area -->
        <div style="position:relative; margin-top:18px; border-top:1px dashed #ddd; padding-top:8px;">
          <p style="margin:0;">Merci pour votre confiance.</p>
        </div>
      </div>
    </t>
  </template>
</odoo>



<!-- <t t-name="account.report_invoice_with_payments">
            <t t-call="account.report_invoice">
                <t t-set="print_with_payments" t-value="True"/>
            </t>
        </t> -->
